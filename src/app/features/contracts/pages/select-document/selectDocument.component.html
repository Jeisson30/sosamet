<div class="contract-card">
  <!-- Dropdown para seleccionar tipo de documento -->
  <div class="dropdown-wrapper">
    <p-dropdown
      [options]="filteredContractTypes"
      optionLabel="tipo_doc"
      optionValue="tipo_doc"
      [(ngModel)]="selectedType"
      placeholder="Seleccione un tipo de documento"
      (onChange)="onTypeChange()"
      class="dropdown"
    ></p-dropdown>
  </div>

  <!-- Formulario din谩mico -->
  <form
    [formGroup]="form"
    (ngSubmit)="onSubmitSelected()"
    *ngIf="fields.length > 0"
    class="form-grid"
  >
    <!-- Recorremos campos y ocultamos los que est茅n en hiddenFields -->
    <ng-container *ngFor="let field of fields">
      <div
        class="form-field"
        *ngIf="!hiddenFields.has(field.nombre_campo_doc)"
        [ngClass]="{
          'full-width':
            field.nombre_campo_doc === 'descripcion' ||
            field.nombre_campo_doc === 'detalle_visita'
        }"
      >
        <!-- Tipo contrato -->
        <p-floatlabel
          variant="over"
          *ngIf="
            field.nombre_campo_doc === 'tipo_contrato';
            else checkEstadoField
          "
        >
          <p-dropdown
            [options]="contractTypeOptions"
            optionLabel="label"
            optionValue="value"
            [formControlName]="field.nombre_campo_doc"
            [inputId]="field.nombre_campo_doc"
            class="w-full"
          ></p-dropdown>
          <label [for]="field.nombre_campo_doc">{{
            field.desc_campo_doc
          }}</label>
        </p-floatlabel>

        <ng-template #checkEstadoField>
          
          <!-- Estado -->
          <p-floatlabel
            variant="over"
            *ngIf="field.nombre_campo_doc === 'estado'; else checkEmpresaAsociada"
          >
            <p-dropdown
              [options]="currentStatusOptions"
              optionLabel="label"
              optionValue="value"
              [formControlName]="field.nombre_campo_doc"
              [inputId]="field.nombre_campo_doc"
              class="w-full"
            ></p-dropdown>
            <label [for]="field.nombre_campo_doc">{{ field.desc_campo_doc }}</label>
          </p-floatlabel>
        </ng-template>

      <ng-template #checkEmpresaAsociada>
        <p-floatlabel
          variant="over"
          *ngIf="field.nombre_campo_doc === 'empresa_asociada'; else checkTipoDocContratista"
        >
          <p-dropdown
            [formControlName]="field.nombre_campo_doc"
            [options]="companies"
            optionLabel="nombre_empresa"
            optionValue="id"
            [inputId]="field.nombre_campo_doc"
            placeholder="Seleccione empresa"
            class="w-full"
          ></p-dropdown>
          <label [for]="field.nombre_campo_doc">{{ field.desc_campo_doc }}</label>
        </p-floatlabel>
      </ng-template>

      <ng-template #checkTipoDocContratista>
        <p-floatlabel
          variant="over"
          *ngIf="field.nombre_campo_doc === 'tipo_doc_contratista'; else checkRealizoPago"
        >
          <p-dropdown
            [options]="typecontractDocumentOptions"
            optionLabel="label"
            optionValue="value"
            [formControlName]="field.nombre_campo_doc"
            [inputId]="field.nombre_campo_doc"
            class="w-full"
          ></p-dropdown>

          <label [for]="field.nombre_campo_doc">
            {{ field.desc_campo_doc }}
          </label>
        </p-floatlabel>
      </ng-template>

        <ng-template #checkRealizoPago>
          <!-- S铆 / No -->
          <p-floatlabel
            variant="over"
            *ngIf="
              [
                'realizo_pago',
                'estado_pago_anticipo',
                'estado_pago_r_garantia',
                'estado_polizas',
                'estado_polizas_in',
                'estado_polizas_fin'
              ].includes(field.nombre_campo_doc);
              else defaultField
            "
          >
            <p-dropdown
              [formControlName]="field.nombre_campo_doc"
              [options]="yesNoOptions"
              optionLabel="label"
              optionValue="value"
              [inputId]="field.nombre_campo_doc"
              class="w-full"
            ></p-dropdown>
            <label [for]="field.nombre_campo_doc">{{
              field.desc_campo_doc
            }}</label>
          </p-floatlabel>
        </ng-template>

        <!-- Default inputs -->
        <ng-template #defaultField>
          <p-floatlabel
            variant="over"
            *ngIf="['text', 'number', 'tel', 'email'].includes(field.tipo_dato)"
          >
            <input
              pInputText
              [type]="field.tipo_dato"
              [formControlName]="field.nombre_campo_doc"
              [id]="field.nombre_campo_doc"
              class="w-full"
            />
            <label [for]="field.nombre_campo_doc">{{
              field.desc_campo_doc
            }}</label>
          </p-floatlabel>

          <p-floatlabel variant="over" *ngIf="field.tipo_dato === 'date'">
            <p-calendar
              [formControlName]="field.nombre_campo_doc"
              [inputId]="field.nombre_campo_doc"
              dateFormat="yy-mm-dd"
              class="w-full"
            ></p-calendar>
            <label [for]="field.nombre_campo_doc">{{
              field.desc_campo_doc
            }}</label>
          </p-floatlabel>

          <p-floatlabel variant="over" *ngIf="field.tipo_dato === 'file'">
            <input
              type="file"
              (change)="onFileChange($event, field.nombre_campo_doc)"
              [id]="field.nombre_campo_doc"
              class="w-full"
            />
            <label [for]="field.nombre_campo_doc">{{
              field.desc_campo_doc
            }}</label>
          </p-floatlabel>
        </ng-template>
      </div>
    </ng-container>

    <!-- CARGA DE ARCHIVOS PLANOS SEGUN TIPO DE DOCUMENTO   -->

    <div *ngIf="selectedType === 'CONTRATO'" class="mt-2">
      <label for="aiuFile">Archivo Excel Contrato AIU:</label>
      <input
        type="file"
        id="aiuFile"
        (change)="onAIUFileSelected($event)"
        accept=".xlsx, .xls"
      />

      <button
        type="button"
        class="custom-upload-button mt-2"
        (click)="uploadAIUExcel()"
      >
        SUBIR
      </button>

      <br />

      <label for="ivaFile" class="mt-3 block">Archivo Excel Contrato IVA:</label>
      <input
        type="file"
        id="ivaFile"
        (change)="onIVAFileSelected($event)"
        accept=".xlsx, .xls"
      />

      <button
        type="button"
        class="custom-upload-button mt-2"
        (click)="uploadIVAExcel()"
      >
        SUBIR
      </button>
    </div>

    <div *ngIf="selectedType === 'ORDEN DE COMPRA'" class="mt-2">
      <label for="ocFile">Archivo Excel Orden de Compra:</label>
      <input
        type="file"
        id="ordenCompraFile"
        (change)="onOCFileSelected($event)"
        accept=".xlsx, .xls"
      />

      <button
        type="button"
        class="custom-upload-button mt-2"
        (click)="uploadOCFile()"
      >
        SUBIR
      </button>
    </div>

    <div *ngIf="selectedType === 'REMISIONES'" class="mt-2">
      <label for="ocFile">Archivo Excel Remisiones:</label>
      <input
        type="file"
        id="remisionesFile"
        (change)="onOCFileRemision($event)"
        accept=".xlsx, .xls"
      />

      <button
        type="button"
        class="custom-upload-button mt-2"
        (click)="uploadOCRemision()"
      >
        SUBIR
      </button>
    </div>

    <div *ngIf="selectedType === 'ACTAS DE PAGO'" class="mt-2">
      <label for="ocFile">Archivo Excel Actas De Pago:</label>
      <input
        type="file"
        id="remisionesFile"
        (change)="onOCFileActaPago($event)"
        accept=".xlsx, .xls"
      />

      <button
        type="button"
        class="custom-upload-button mt-2"
        (click)="uploadOCActaCompra()"
      >
        SUBIR
      </button>
    </div>


    <!-- Botones de acciones (independientes por tipo) -->
    <div class="form-actions" *ngIf="selectedType === 'CONTRATO'">
      <div class="button-group">
        <button
          type="button"
          (click)="onPreviewContrato()"
          class="custom-save-button"
        >
          PREVISUALIZAR
        </button>
        <button
          type="button"
          (click)="onSubmitContrato()"
          class="custom-save-button"
        >
          GUARDAR
        </button>
      </div>
    </div>

    <div class="form-actions" *ngIf="selectedType === 'ASISTENCIA'">
      <div class="button-group">
        <button
          type="button"
          (click)="onPreviewVisita()"
          class="custom-save-button"
        >
          PREVISUALIZAR
        </button>
        <button
          type="button"
          (click)="onSubmitVisita()"
          class="custom-save-button"
        >
          GUARDAR
        </button>
      </div>
    </div>

    <div class="form-actions" *ngIf="selectedType === 'ACTAS DE MEDIDA'">
      <div class="button-group">
        <button
          type="button"
          (click)="onPreviewActa()"
          class="custom-save-button"
        >
          PREVISUALIZAR
        </button>
        <button
          type="button"
          (click)="onSubmitActa()"
          class="custom-save-button"
        >
          GUARDAR
        </button>
      </div>
    </div>

    <div class="form-actions" *ngIf="selectedType === 'REMISIONES'">
      <div class="button-group">
        <button
          type="button"
          (click)="onPreviewRemision()"
          class="custom-save-button"
        >
          PREVISUALIZAR
        </button>
        <button
          type="button"
          (click)="onSubmitRemision()"
          class="custom-save-button"
        >
          GUARDAR
        </button>
      </div>
    </div>

    <div class="form-actions" *ngIf="selectedType === 'ORDEN DE COMPRA'">
      <div class="button-group">
        <button
          type="button"
          (click)="onPreviewOC()"
          class="custom-save-button"
        >
          PREVISUALIZAR
        </button>
        <!-- Guardar inputs -->
        <button
          type="button"
          class="custom-save-button mt-2"
          (click)="saveOCInputs()"
        >
          GUARDAR
        </button>
      </div>
    </div>

    <div class="form-actions" *ngIf="selectedType === 'ACTAS DE PAGO'">
      <div class="button-group">
        <button
          type="button"
          (click)="onPreviewAC()"
          class="custom-save-button"
        >
          PREVISUALIZAR
        </button>
        <!-- Guardar inputs -->
        <button
          type="button"
          class="custom-save-button mt-2"
          (click)="saveOCInputs()"
        >
          GUARDAR
        </button>
      </div>
    </div>
  </form>

  <!-- PREVISUALIZACIN: CONTRATO -->
  <div *ngIf="showPreviewContrato" class="preview-card mt-4">
    <h3 class="mb-4 text-xl font-bold"> Previsualizaci贸n del contrato</h3>

    <!-- Empresa: siempre ocupa toda la fila -->
    <div class="preview-box full-row">
      <div class="box-title">Empresa</div>
      <table class="preview-table">
        <tr>
          <th>Empresa</th>
          <td>{{ form.value["empresa"] }}</td>
        </tr>
        <tr>
          <th>NIT</th>
          <td>{{ form.value["nit_empresa"] }}</td>
        </tr>
        <tr>
          <th>Ciudad</th>
          <td>{{ form.value["ciudad_empresa"] }}</td>
        </tr>
      </table>
    </div>

    <!-- Otras secciones en grilla -->
    <div class="grid-preview">
      <!-- Contrato -->
      <div class="preview-box">
        <div class="box-title">Contrato Detallado Por Grupos</div>
        <table class="preview-table">
          <tr>
            <th>Contrato No.</th>
            <td>{{ form.value["numero_contrato"] }}</td>
          </tr>
          <tr>
            <th>Proyecto</th>
            <td>{{ form.value["proyecto"] }}</td>
          </tr>
          <tr>
            <th>Valor Contrato</th>
            <td>{{ form.value["valor_contrato"] }}</td>
          </tr>
          <tr>
            <th>Tipo Contrato</th>
            <td>{{ form.value["tipo_contrato"] }}</td>
          </tr>
          <tr>
            <th>Estado</th>
            <td>{{ form.value["estado"] }}</td>
          </tr>
          <tr>
            <th>Fecha Inicio</th>
            <td>{{ form.value["fecha_inicio"] | date }}</td>
          </tr>
          <tr>
            <th>Fecha Fin</th>
            <td>{{ form.value["fecha_fin"] | date }}</td>
          </tr>
          <tr>
            <th>Descripci贸n</th>
            <td>{{ form.value["descripcion"] }}</td>
          </tr>
        </table>
      </div>

      <!-- Anticipo -->
      <div class="preview-box">
        <div class="box-title">Anticipo</div>
        <table class="preview-table">
          <tr>
            <th>% Anticipo</th>
            <td>{{ form.value["porcentaje_anticipo"] }}</td>
          </tr>
          <tr>
            <th>Valor anticipo</th>
            <td>{{ form.value["Valor anticipo"] }}</td>
          </tr>
          <tr>
            <th>Estado pago</th>
            <td>{{ form.value["estado_pago_anticipo"] }}</td>
          </tr>
        </table>
      </div>

      <!-- Retenci贸n garant铆a -->
      <div class="preview-box">
        <div class="box-title">Retenci贸n garant铆a</div>
        <table class="preview-table">
          <tr>
            <th>Rete garant铆a</th>
            <td>{{ form.value["rete_garantia"] }}</td>
          </tr>
          <tr>
            <th>Valor R garant铆a</th>
            <td>{{ form.value["valor_r_garantia"] }}</td>
          </tr>
          <tr>
            <th>Estado pago</th>
            <td>{{ form.value["estado_pago_r_garantia"] }}</td>
          </tr>
        </table>
      </div>

      <!-- P贸lizas -->
      <div class="preview-box">
        <div class="box-title">P贸lizas</div>
        <table class="preview-table">
          <tr>
            <th>P贸lizas</th>
            <td>{{ form.value["polizas"] }}</td>
          </tr>
          <tr>
            <th>Valor p贸lizas</th>
            <td>{{ form.value["valor_polizas"] }}</td>
          </tr>
          <tr>
            <th>Estado p贸lizas</th>
            <td>{{ form.value["estado_polizas"] }}</td>
          </tr>
        </table>
      </div>

      <!-- Valores econ贸micos -->
      <div class="preview-box">
        <div class="box-title">Valores econ贸micos</div>
        <table class="preview-table">
          <tr>
            <th>Facturado</th>
            <td>{{ form.value["facturado"] }}</td>
          </tr>
          <tr>
            <th>Saldo contrato</th>
            <td>{{ form.value["saldo_contrato"] }}</td>
          </tr>
        </table>
      </div>
    </div>

    <div class="mt-3 flex justify-end">
      <button
        type="button"
        (click)="closePreviewContrato()"
        class="custom-save-button"
      >
        Cerrar
      </button>
    </div>
  </div>

  <!-- PREVISUALIZACIN: ASISTENCIA -->
  <div *ngIf="showPreviewVisita" class="preview-card mt-4">
    <h3 class="mb-4 text-xl font-bold"> Previsualizaci贸n visita de obra</h3>

    <div class="grid-preview">
      <div class="preview-box">
        <div class="box-title">Datos</div>
        <table class="preview-table">
          <tr>
            <th>Consecutivo</th>
            <td>{{ form.value["consecutivo"] }}</td>
          </tr>
          <tr>
            <th>Constructora</th>
            <td>{{ form.value["constructora"] }}</td>
          </tr>
          <tr>
            <th>Proyecto</th>
            <td>{{ form.value["proyecto"] }}</td>
          </tr>
          <tr>
            <th>Ubicaci贸n</th>
            <td>{{ form.value["ubicacion"] }}</td>
          </tr>
        </table>
      </div>

      <div class="preview-box full-row">
        <div class="box-title">Detalle de la visita</div>
        <div style="color: #fff">{{ form.value["detalle_visita"] }}</div>
      </div>

      <div class="preview-box full-row">
        <div class="box-title">Adjuntos</div>
        <div class="flex gap-4">
          <!-- Foto 1 -->
          <div class="photo-thumbnail" *ngIf="getFotoUrl('foto1')">
            <img
              [src]="getFotoUrl('foto1')"
              alt="Foto 1"
              class="thumbnail-img"
            />
            <p class="photo-label">Foto 1</p>
          </div>

          <!-- Foto 2 -->
          <div class="photo-thumbnail" *ngIf="getFotoUrl('foto2')">
            <img
              [src]="getFotoUrl('foto2')"
              alt="Foto 2"
              class="thumbnail-img"
            />
            <p class="photo-label">Foto 2</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- PREVISUALIZACIN: ACTA -->
  <div *ngIf="showPreviewActa" class="preview-card mt-4">
    <h3 class="mb-4 text-xl font-bold"> Previsualizaci贸n del Acta</h3>

    <div class="grid-preview">
      <!-- Bloque 1: Datos b谩sicos -->
      <div class="preview-box full-row">
        <div class="box-title"> Datos del Acta</div>
        <table class="preview-table">
          <tr>
            <th>N煤mero Contrato</th>
            <td>{{ form.value["numero_contrato"] }}</td>
          </tr>
          <tr>
            <th>Consecutivo</th>
            <td>{{ form.value["consecutivo"] }}</td>
          </tr>
          <tr>
            <th>Constructora</th>
            <td>{{ form.value["constructora"] }}</td>
          </tr>
          <tr>
            <th>Proyecto</th>
            <td>{{ form.value["proyecto"] }}</td>
          </tr>
          <tr>
            <th>Estado</th>
            <td>{{ form.value["estado"] }}</td>
          </tr>
          <tr>
            <th>Fecha Terminaci贸n</th>
            <td>{{ form.value["fecha terminaci贸n"] | date }}</td>
          </tr>
        </table>
      </div>

      <!-- Bloque 2: Producci贸n + Despiece + Observaciones -->
      <div class="preview-box full-row">
        <div class="box-title"> Detalles del Acta</div>
        <table class="preview-table">
          <tr>
            <th>Producci贸n</th>
            <td>{{ form.value["acta_produccion"] }}</td>
          </tr>
          <tr>
            <th>Despiece Material</th>
            <td>{{ form.value["despiece_material"] }}</td>
          </tr>
          <tr>
            <th>Observaciones</th>
            <td>{{ form.value["observaciones"] }}</td>
          </tr>
        </table>
      </div>

      <!-- Bloque 3: Adjuntos -->
      <div class="preview-box full-row">
        <div class="box-title"> Adjuntos</div>
        <div class="flex gap-4 flex-wrap">
          <!-- Foto 1 -->
          <div class="photo-thumbnail" *ngIf="getFotoUrl('fotos_1')">
            <img
              [src]="getFotoUrl('fotos_1')"
              alt="Foto 1"
              class="thumbnail-img"
            />
            <p class="photo-label">Foto 1</p>
          </div>

          <!-- Foto 2 -->
          <div class="photo-thumbnail" *ngIf="getFotoUrl('foto_2')">
            <img
              [src]="getFotoUrl('foto_2')"
              alt="Foto 2"
              class="thumbnail-img"
            />
            <p class="photo-label">Foto 2</p>
          </div>

          <!-- Foto 3 -->
          <div class="photo-thumbnail" *ngIf="getFotoUrl('foto_3')">
            <img
              [src]="getFotoUrl('foto_3')"
              alt="Foto 3"
              class="thumbnail-img"
            />
            <p class="photo-label">Foto 3</p>
          </div>
        </div>
      </div>
    </div>

    <div class="mt-3 flex justify-end">
      <button
        type="button"
        (click)="closePreviewActa()"
        class="custom-save-button"
      >
        Cerrar
      </button>
    </div>
  </div>

  <!-- PREVISUALIZACIN: ORDEN DE COMPRA -->
  <div *ngIf="showPreviewOC" class="preview-card mt-4">
    <h3 class="mb-4 text-xl font-bold"> Previsualizaci贸n Orden de Compra</h3>

    <div class="grid-preview">
      <!-- Bloque 1: Datos b谩sicos -->
      <div class="preview-box full-row">
        <div class="box-title"> Datos</div>
        <table class="preview-table">
          <tr>
            <th>N煤mero Contrato</th>
            <td>{{ form.value["numero_contrato"] }}</td>
          </tr>
          <tr>
            <th>Consecutivo</th>
            <td>{{ form.value["consecutivo"] }}</td>
          </tr>
          <tr>
            <th>Constructora</th>
            <td>{{ form.value["constructora"] }}</td>
          </tr>
          <tr>
            <th>Proyecto</th>
            <td>{{ form.value["proyecto"] }}</td>
          </tr>
          <tr>
            <th>Fecha Terminaci贸n</th>
            <td>{{ form.value["fecha_terminacion"] | date }}</td>
          </tr>
        </table>
      </div>

      <!-- Bloque 2: Detalle de compra -->
      <div class="preview-box full-row">
        <div class="box-title"> Detalles</div>
        <table class="preview-table">
          <tr>
            <th>Elabor贸</th>
            <td>{{ form.value["numero_plano"] }}</td>
          </tr>
          <tr>
            <th>Estado</th>
            <td>{{ form.value["estado"] }}</td>
          </tr>
          <tr>
            <th>Observaciones</th>
            <td>{{ form.value["observaciones"] }}</td>
          </tr>
        </table>
      </div>

      <!-- Bloque 3: Adjuntos -->
      <div class="preview-box full-row">
        <div class="box-title"> Adjuntos</div>
        <div class="flex gap-4 flex-wrap">
          <!-- Foto 1 -->
          <div class="photo-thumbnail" *ngIf="getFotoUrl('foto_1_orden')">
            <img
              [src]="getFotoUrl('foto_1_orden')"
              alt="Foto 1"
              class="thumbnail-img"
            />
            <p class="photo-label">Foto 1</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Bot贸n cerrar -->
    <div class="mt-3 flex justify-end">
      <button
        type="button"
        (click)="closePreviewOC()"
        class="custom-save-button"
      >
        Cerrar
      </button>
    </div>
  </div>

  <!-- PREVISUALIZACIN: ACTASDE PAGO -->
  <div *ngIf="showPreviewAP" class="preview-card mt-4">
    <h3 class="mb-4 text-xl font-bold"> Previsualizaci贸n Actas De Pago</h3>

    <div class="grid-preview">
      <!-- Bloque 1: Datos b谩sicos -->
      <div class="preview-box full-row">
        <div class="box-title"> Datos</div>
        <table class="preview-table">
          <tr>
            <th>N煤mero Contrato</th>
            <td>{{ form.value["numero_contrato"] }}</td>
          </tr>
          <tr>
            <th>Empresa</th>
            <td>{{ form.value["empresa"] }}</td>
          </tr>
          <tr>
            <th>Proyecto</th>
            <td>{{ form.value["proyecto"] }}</td>
          </tr>
          <tr>
            <th>Estado</th>
            <td>{{ form.value["estado"] }}</td>
          </tr>
        </table>
      </div>

      <!-- Bloque 2: Adjuntos -->
      <div class="preview-box full-row">
        <div class="box-title"> Adjuntos</div>
        <div class="flex gap-4 flex-wrap">
          <!-- Foto 1 -->
          <div class="photo-thumbnail" *ngIf="getFotoUrl('foto1')">
            <img
              [src]="getFotoUrl('foto1')"
              alt="Foto 1"
              class="thumbnail-img"
            />
            <p class="photo-label">Adjuntar Documento/Foto</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Bot贸n cerrar -->
    <div class="mt-3 flex justify-end">
      <button
        type="button"
        (click)="closePreviewAP()"
        class="custom-save-button"
      >
        Cerrar
      </button>
    </div>
  </div>

  <!-- PREVISUALIZACIN: REMISIONES -->
  <div *ngIf="showPreviewRemision" class="preview-card mt-4">
    <h3 class="mb-4 text-xl font-bold"> Previsualizaci贸n Remisiones</h3>

    <div class="grid-preview">
      <!-- Datos b谩sicos -->
      <div class="preview-box full-row">
        <div class="box-title"> Datos de la Remisi贸n</div>
        <table class="preview-table">
          <tr>
            <th>N煤mero Contrato</th>
            <td>{{ form.value["numero_contrato"] }}</td>
          </tr>
          <tr>
            <th>Remisi贸n N掳</th>
            <td>{{ form.value["remision_material"] }}</td>
          </tr>
          <tr>
            <th>Fecha</th>
            <td>{{ form.value["fecha_remision"] }}</td>
          </tr>
          <tr>
            <th>Constructora</th>
            <td>{{ form.value["cliente"] }}</td>
          </tr>
          <tr>
            <th>Proyecto</th>
            <td>{{ form.value["proyecto"] }}</td>
          </tr>
          <tr>
            <th>Despachado Por:</th>
            <td>{{ form.value["despacho"] }}</td>
          </tr>
          <tr>
            <th>Transport贸:</th>
            <td>{{ form.value["transporto"] }}</td>
          </tr>
          <tr>
            <th>Empresa Asociada:</th>
            <td>{{ empresaImpresion }}</td>
          </tr>
        </table>
      </div>
    </div>

    <!-- Acciones -->
    <div class="mt-3 flex justify-end gap-2">
      <button
        type="button"
        (click)="closePreviewRemision()"
        class="custom-save-button"
      >
        Cerrar
      </button>

      <button
        type="button"
        (click)="onPrintRemision()"
        class="custom-save-button"
      >
        Imprimir
      </button>
    </div>
  </div>

  <!-- FORMATO DE IMPRESIN RM -->
  <div class="print-page" *ngIf="showPreviewRemision">

  <!-- COPIA 1 -->
  <div class="remision-copy">
    <ng-container *ngTemplateOutlet="rmFormato"></ng-container>
  </div>

  <!-- COPIA 2 -->
    <div class="remision-copy">
      <ng-container *ngTemplateOutlet="rmFormato"></ng-container>
    </div>

  </div>

  <ng-template #rmFormato>
    <div class="rm-empresa">{{ empresaImpresion }}</div>

    <div class="rm-fecha-dia">{{ fechaDia }}</div>
    <div class="rm-fecha-mes">{{ fechaMes }}</div>
    <div class="rm-fecha-anio">{{ fechaAnio }}</div>

    <div class="rm-consecutivo">{{ form.value["remision_material"] }}</div>
    <div class="rm-cliente">{{ form.value["cliente"] }}</div>
    <div class="rm-proyecto">{{ form.value["proyecto"] }}</div>
    <div class="rm-despacho">{{ form.value["despacho"] }}</div>
    <div class="rm-transporto">{{ form.value["transporto"] }}</div>
  </ng-template>
</div>
